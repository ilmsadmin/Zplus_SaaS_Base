# Zplus SaaS Base - Backend Environment Configuration
# Copy this file to .env and update with your values

# ================================
# Application Configuration
# ================================
APP_NAME=Zplus SaaS Base
APP_ENV=development
APP_VERSION=1.0.0
APP_DEBUG=true

# Server Configuration
SERVER_HOST=localhost
SERVER_PORT=8080
SERVER_READ_TIMEOUT=30s
SERVER_WRITE_TIMEOUT=30s
SERVER_IDLE_TIMEOUT=120s
GRACEFUL_SHUTDOWN_TIMEOUT=30s

# API Configuration
API_BASE_PATH=/api/v1
GRAPHQL_PATH=/graphql

# ================================
# Database Configuration
# ================================

# PostgreSQL (Primary Database)
DB_DRIVER=postgres
DB_HOST=postgres
DB_PORT=5432
DB_NAME=zplus
DB_USER=postgres
DB_PASSWORD=postgres123
DB_SSLMODE=disable
DB_MAX_OPEN_CONNS=25
DB_MAX_IDLE_CONNS=5
DB_CONN_MAX_LIFETIME=300s

# Database URL (Overrides individual settings)
DATABASE_URL=postgres://postgres:postgres123@postgres:5432/zplus?sslmode=disable

# MongoDB (Metadata & Documents)
MONGODB_HOST=mongodb
MONGODB_PORT=27017
MONGODB_DATABASE=zplus_metadata
MONGODB_USERNAME=mongo
MONGODB_PASSWORD=mongo123
MONGODB_AUTH_SOURCE=admin
MONGODB_TIMEOUT=10s
MONGODB_URL=mongodb://mongo:mongo123@mongodb:27017/zplus_metadata?authSource=admin

# Redis (Cache & Sessions)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis123
REDIS_DB=0
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=3
REDIS_URL=redis://:redis123@redis:6379/0

# ================================
# Multi-Tenancy Configuration
# ================================

# Tenant Strategy
TENANT_STRATEGY=schema  # Options: schema, database, hybrid
DEFAULT_TENANT=system
TENANT_HEADER=X-Tenant-ID
TENANT_RESOLVER=subdomain  # Options: subdomain, header, param

# Schema Management
AUTO_MIGRATE=true
ENABLE_TENANT_ISOLATION=true
TENANT_SCHEMA_PREFIX=tenant_

# ================================
# Authentication & Authorization
# ================================

# JWT Configuration
JWT_SECRET=your-super-secret-jwt-key-minimum-256-bits-for-development
JWT_ISSUER=zplus-api
JWT_AUDIENCE=zplus-client
JWT_ACCESS_EXPIRATION=15m
JWT_REFRESH_EXPIRATION=7d
JWT_ALGORITHM=HS256

# Keycloak Integration
KEYCLOAK_URL=http://keycloak:8080
KEYCLOAK_REALM=zplus
KEYCLOAK_BACKEND_CLIENT_ID=zplus-backend
KEYCLOAK_BACKEND_SECRET=zplus-backend-secret-2024
KEYCLOAK_ADMIN_CLIENT_ID=zplus-admin-frontend
KEYCLOAK_ADMIN_SECRET=zplus-admin-frontend-secret-2024
KEYCLOAK_TENANT_CLIENT_ID=zplus-tenant-frontend
KEYCLOAK_TENANT_SECRET=zplus-tenant-frontend-secret-2024
KEYCLOAK_VERIFY_SSL=false

# Session Configuration
SESSION_SECRET=your-session-secret-key
SESSION_DURATION=24h
SESSION_SECURE=false  # Set to true in production with HTTPS

# RBAC Configuration
RBAC_MODEL_PATH=./configs/rbac_model.conf
RBAC_POLICY_PATH=./configs/rbac_policy.csv
ENABLE_CASBIN=true

# ================================
# GraphQL Configuration
# ================================

# GraphQL Settings
GRAPHQL_PLAYGROUND=true
GRAPHQL_INTROSPECTION=true
GRAPHQL_MAX_QUERY_DEPTH=10
GRAPHQL_MAX_QUERY_COMPLEXITY=1000
GRAPHQL_ENABLE_TRACING=true

# GraphQL Federation
FEDERATION_ENABLED=false
SCHEMA_REGISTRY_URL=http://schema-registry:8080

# ================================
# API Gateway & Routing
# ================================

# CORS Configuration
CORS_ENABLED=true
CORS_ALLOWED_ORIGINS=http://localhost:3000,http://admin.localhost,http://tenant1.localhost
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,PATCH,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Tenant-ID,X-Requested-With
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPS=100
RATE_LIMIT_BURST=200
RATE_LIMIT_CLEANUP_INTERVAL=60s

# Request/Response
REQUEST_TIMEOUT=30s
MAX_REQUEST_SIZE=10MB
ENABLE_REQUEST_ID=true

# ================================
# File Storage Configuration
# ================================

# Storage Provider
STORAGE_PROVIDER=local  # Options: local, s3, gcs, azure

# Local Storage
LOCAL_STORAGE_PATH=./uploads
LOCAL_STORAGE_URL_PREFIX=/files

# AWS S3
AWS_REGION=us-west-2
AWS_ACCESS_KEY_ID=your-aws-access-key
AWS_SECRET_ACCESS_KEY=your-aws-secret-key
S3_BUCKET=zplus-files-dev
S3_ENDPOINT=
S3_FORCE_PATH_STYLE=false
S3_PUBLIC_READ=false

# File Upload Limits
MAX_FILE_SIZE=50MB
ALLOWED_FILE_TYPES=jpg,jpeg,png,gif,pdf,doc,docx,xls,xlsx,ppt,pptx,zip
IMAGE_RESIZE_ENABLED=true
IMAGE_QUALITY=85

# ================================
# Email & Notifications
# ================================

# SMTP Configuration
SMTP_HOST=mailhog
SMTP_PORT=1025
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@zplus.io
SMTP_FROM_NAME=Zplus SaaS
SMTP_USE_TLS=false

# Email Templates
EMAIL_TEMPLATE_PATH=./templates/emails
DEFAULT_LOCALE=en
SUPPORTED_LOCALES=en,vi

# Notification Settings
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_PUSH_NOTIFICATIONS=false
NOTIFICATION_QUEUE=notifications

# ================================
# Background Jobs & Queue
# ================================

# Queue Configuration
QUEUE_PROVIDER=redis  # Options: redis, memory
QUEUE_REDIS_URL=redis://:redis123@redis:6379/1
QUEUE_CONCURRENCY=5
QUEUE_MAX_RETRIES=3
QUEUE_RETRY_DELAY=5s

# Background Jobs
ENABLE_BACKGROUND_JOBS=true
JOB_CLEANUP_INTERVAL=1h
FAILED_JOB_RETENTION=7d

# Scheduled Jobs
ENABLE_CRON_JOBS=true
BACKUP_SCHEDULE=0 2 * * *
CLEANUP_SCHEDULE=0 3 * * 0
METRICS_COLLECTION_SCHEDULE=*/5 * * * *

# ================================
# Monitoring & Observability
# ================================

# Logging
LOG_LEVEL=debug  # Options: debug, info, warn, error
LOG_FORMAT=json  # Options: json, text
LOG_OUTPUT=stdout
LOG_FILE_PATH=./logs/app.log
LOG_MAX_SIZE=100  # MB
LOG_MAX_BACKUPS=10
LOG_MAX_AGE=30  # days

# Metrics
METRICS_ENABLED=true
METRICS_PATH=/metrics
METRICS_NAMESPACE=zplus_api

# Health Checks
HEALTH_CHECK_PATH=/health
READINESS_CHECK_PATH=/ready
LIVENESS_CHECK_PATH=/live

# Distributed Tracing
TRACING_ENABLED=false
JAEGER_ENDPOINT=http://jaeger:14268/api/traces
JAEGER_SERVICE_NAME=zplus-api
JAEGER_SAMPLE_RATE=0.1

# Performance Monitoring
ENABLE_PPROF=true
PPROF_PORT=6060

# ================================
# Security Configuration
# ================================

# Encryption
ENCRYPTION_KEY=your-32-character-encryption-key
PASSWORD_SALT_ROUNDS=12
PASSWORD_MIN_LENGTH=8

# Security Headers
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
CSP_ENABLED=true
CSP_POLICY=default-src 'self'

# API Security
API_KEY_HEADER=X-API-Key
ENABLE_API_KEY_AUTH=true
RATE_LIMIT_BY_IP=true

# TLS Configuration
TLS_ENABLED=false
TLS_CERT_PATH=./certs/server.crt
TLS_KEY_PATH=./certs/server.key

# ================================
# Cache Configuration
# ================================

# Application Cache
CACHE_ENABLED=true
CACHE_TTL=1h
CACHE_MAX_SIZE=1000

# Query Cache
QUERY_CACHE_ENABLED=true
QUERY_CACHE_TTL=5m

# Redis Cache
REDIS_CACHE_PREFIX=zplus:cache:
REDIS_CACHE_TTL=3600s

# ================================
# External Services
# ================================

# Payment Processing
STRIPE_PUBLIC_KEY=pk_test_your_stripe_public_key
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret
STRIPE_API_VERSION=2023-10-16

# Analytics
ENABLE_ANALYTICS=false
ANALYTICS_PROVIDER=mixpanel
MIXPANEL_TOKEN=your-mixpanel-token

# Maps & Location
GOOGLE_MAPS_API_KEY=your-google-maps-api-key

# ================================
# Development Configuration
# ================================

# Hot Reload
HOT_RELOAD=true
WATCH_PATHS=./cmd,./internal,./pkg

# Debug Settings
DEBUG_SQL=true
DEBUG_REDIS=false
DEBUG_MONGO=false
SHOW_REQUEST_LOGS=true

# Development Tools
ENABLE_MOCK_DATA=true
MOCK_DATA_PATH=./mocks
ENABLE_PROFILER=true

# Testing
TEST_DB_URL=postgres://postgres:postgres123@postgres:5432/zplus_test?sslmode=disable
TEST_REDIS_URL=redis://:redis123@redis:6379/15
INTEGRATION_TESTS_ENABLED=true

# ================================
# Feature Flags
# ================================

# Core Features
ENABLE_USER_REGISTRATION=true
ENABLE_TENANT_CREATION=true
ENABLE_CUSTOM_DOMAINS=true
ENABLE_FILE_UPLOADS=true

# Advanced Features
ENABLE_ANALYTICS=false
ENABLE_AUDIT_LOGS=true
ENABLE_API_VERSIONING=true
ENABLE_WEBHOOKS=false

# Experimental Features
ENABLE_REAL_TIME=false
ENABLE_AI_FEATURES=false
ENABLE_BLOCKCHAIN=false

# ================================
# Production Overrides
# ================================
# Uncomment and modify these for production deployment

# Security
# JWT_SECRET=generate-strong-production-secret
# SESSION_SECRET=generate-strong-session-secret
# ENCRYPTION_KEY=generate-32-char-production-key

# Performance
# LOG_LEVEL=info
# DEBUG_SQL=false
# SHOW_REQUEST_LOGS=false
# GRAPHQL_PLAYGROUND=false
# GRAPHQL_INTROSPECTION=false

# Database
# DATABASE_URL=postgres://user:pass@prod-db:5432/zplus
# MONGODB_URL=mongodb://user:pass@prod-mongo:27017/zplus
# REDIS_URL=redis://prod-redis:6379/0

# External Services
# SMTP_HOST=your-production-smtp-host
# SMTP_PORT=587
# SMTP_USE_TLS=true

# Security
# TLS_ENABLED=true
# SESSION_SECURE=true
# CORS_ALLOWED_ORIGINS=https://yourdomain.com
